:html_theme.sidebar_secondary.remove:

.. _tutorials:

Tutorials
=========

**nwb2bids** comes pre-packaged with some demonstrative tools to help showcase its functionality on various types of
NWB file contents. No additional requirements, knowledge, or experience are necessary to run these tutorials!



Tutorial 1 - Converting a single file
-------------------------------------

In case you don't have any NWB files handy, or perhaps you've never worked with NWB files before, you can generate a
toy example through the command line interface (CLI) as follows:

.. code-block:: bash

    nwb2bids tutorial generate ephys

This created an NWB file with contents typical of an extracellular electrophysiology experiment in your home
directory for **nwb2bids**: ``~/.nwb2bids/tutorials/ephys/nwb2bids_tutorial_ephys.nwb``.

.. note::

    Don't like overwhelming your home directory with lots of small files?

    You can control where tutorial data is generated by using the ``--output-directory`` flag (or ``-o`` for short):

    .. code-block:: bash

        nwb2bids tutorial generate ephys --output-directory path/to/some/directory

NWB files like this contain a lot of metadata about the probes and electrode structure, which will be useful later
when we compare the source file to the sidecar tables found in BIDS. You can explore these file contents through
`neurosift.app <neurosift.app>`_ by following this link: TODO

.. tip::

    The link above actually points to a similar file published on the DANDI Archive, which should be identical to
    what what written on your system. You can explore and visualize your local file contents and structure
    in many other ways, such as the
    `NWB GUIDE <https://nwb-guide.readthedocs.io/en/stable/installation.html>`_,
    `HDFView <https://www.hdfgroup.org/download-hdfview/>`_, or the
    `PyNWB library <https://pynwb.readthedocs.io/en/stable/tutorials/general/plot_read_basics.html#reading-and-exploring-an-nwb-file>`_.

Now that we have an NWB file, we can convert it to BIDS using the following command:

.. code-block:: bash

    nwb2bids convert ~/.nwb2bids/tutorials/ephys/nwb2bids_tutorial_ephys.nwb --bids-directory ~/.nwb2bids/tutorials/ephys/bids_dataset

Notice how we explicitly specified the output BIDS directory using the ``--bids-directory`` flag. We will cover the
implicit (current working directory) approach in TODO: crossref to later tutorial.


Tutorial 2 - Converting multiple files
--------------------------------------



.. tip::

    Lost in the CLI? Can't remember the exact phrase to type when navigating through the command groups? No worries!
    Simply add the ``--help`` to any command to see detailed descriptions, expected inputs, and optional flags.

    You can also see a layout of the command structure by calling each level at a time, for example ``nwb2bids``,
    ``nwb2bids tutorial``, and so on.

    Try it out on ``nwb2bids tutorial generate`` to see all the types of tutorial data we can generate for you.

This command assumes you are located within either an empty directory or a BIDS dataset, informing you accordingly if
these conditions are not met.

To specify a specific location other than your current working directory, use the ``--bids-directory``
flag (or ``-o`` for short):

.. code-block:: bash

   nwb2bids convert [path to NWB files] --bids-directory [path to BIDS directory]

The main input to the interface can be any combination of directories containing NWB files or individual NWB files:

.. code-block:: bash

   nwb2bids convert path/to/many/nwb single.nwb another.nwb



Application Programming Interface (API)
---------------------------------------

A more advanced usage of **nwb2bids** is through its Python library. A thorough description of all publicly exposed
functions and classes can be found in the :ref:`API <api>` section of the documentation.

The core function is the ``convert_nwb_to_bids`` function, which can be used as follows:

.. code-block:: python

   import nwb2bids

   nwb2bids.convert_nwb_to_bids(
       nwb_paths=["path/to/many/nwb", "single.nwb", "another.nwb"],
       bids_directory="path/to/bids/directory"  # Optional, defaults to current working directory
   )

Essentially, this function is direct wrapper used by the CLI and behaves in the same way.

One key programmatic difference however is the ability to interact with the notifications returned by the operation:

.. code-block:: python

   import nwb2bids

   notifications = nwb2bids.convert_nwb_to_bids(
       nwb_paths=["path/to/many/nwb", "single.nwb", "another.nwb"],
       bids_directory="path/to/bids/directory"
   )

   for notification in notifications:
       print(notification)

More examples to follow soon...
